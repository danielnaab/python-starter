{% if include_example_code -%}
"""Repository protocol — generic persistence interface.

Defines interface for entity storage using typing.Protocol for structural typing.
Ports belong to the domain: the domain defines what it needs from the outside world.
"""

from typing import Generic, Optional, Protocol, TypeVar

T = TypeVar("T")


class Repository(Protocol, Generic[T]):
    """Generic repository for entity persistence.

    Any class implementing these methods satisfies this protocol.
    No inheritance required - structural typing (duck typing with type safety).

    Type parameter T represents the entity type being stored.

    Example implementations:
        - InMemoryRepository[Entity]
        - PostgresRepository[User]
        - SQLiteRepository[Product]
    """

    def save(self, entity: T) -> None:
        """Persist entity to storage.

        Implementations should be idempotent - saving same entity twice
        should not create duplicates.

        Args:
            entity: Entity to save
        """
        ...

    def get(self, entity_id: str) -> Optional[T]:
        """Retrieve entity by ID.

        Args:
            entity_id: Unique identifier

        Returns:
            Entity if found, None otherwise
        """
        ...

    def list_all(self) -> list[T]:
        """Retrieve all entities.

        Returns:
            List of all entities (empty list if none)
        """
        ...

    def delete(self, entity_id: str) -> bool:
        """Delete entity by ID.

        Args:
            entity_id: Unique identifier

        Returns:
            True if entity was deleted, False if not found
        """
        ...
{% else -%}
"""Repository protocol — generic persistence interface.

Define your repository protocols here using typing.Protocol for structural typing.
Ports belong to the domain: the domain defines what it needs from the outside world.

Example:
    from typing import Protocol, Generic, TypeVar, Optional

    T = TypeVar("T")

    class Repository(Protocol, Generic[T]):
        def save(self, entity: T) -> None: ...
        def get(self, entity_id: str) -> Optional[T]: ...
"""
{% endif -%}
